<!DOCTYPE html>
<html>
<head>
    <title>Planta de Grupo KH</title> 
    <link rel="shortcut icon" type="image/x-icon" href="../images/logo_kh.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"> 
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <!-- Hojas de estilo corporativas -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/themes/base/jquery-ui.min.css">
    
    <!-- jQuery y jQuery Mobile (mantenidos para compatibilidad) -->
    <script src="../libs/jquery-2.1.4.min.js"></script>
    <script src="../libs/jquery.mobile-1.4.5.min.js"></script>
    <script src="../libs/jquery.blockUI.js"></script>
    <script src="../libs/DataTables/datatables.js"></script>
    
    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            background-color: #f5f5f5;
            color: #333;
            overflow: hidden;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background-color: #af4c50;
            color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
            height: 80px;
        }
        
        .logo {
            width: 60px;
            height: 60px;
            background-color: #FFFFFF;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 5px;
        }
        
        .logo img {
            max-width: 100%;
            max-height: 100%;
        }
        
        .app-title {
            flex-grow: 1;
            text-align: center;
            font-size: 1.5rem;
            margin: 0 10px;
        }
        
        .header-info {
            position: relative;
        }
        
        .menu-button {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px;
        }
        
        .dropdown-menu {
            display: none;
            position: absolute;
            right: 0;
            top: 100%;
            background-color: white;
            min-width: 160px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            z-index: 1;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .dropdown-menu a {
            color: #333;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            text-align: left;
        }
        
        .dropdown-menu a:hover {
            background-color: #f1f1f1;
        }
        
        .show {
            display: block;
        }
        
        .main-content {
            flex-grow: 1;
            padding: 20px;
            background-color: white;
            margin: 10px;
            border-radius: 5px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
        }
        
        .ui-grid-d, .ui-grid-a {
            display: flex;
            width: 100%;
        }
        
        .ui-block-a, .ui-block-b, .ui-block-c, .ui-block-d, .ui-block-e {
            padding: 10px;
        }
        
        .ui-block-a { width: 20%; }
        .ui-block-b { width: 18%; }
        .ui-block-c { width: 44%; }
        .ui-block-d { width: 18%; }
        
        #posicion, #posicionD, #referencia, #descripcion, #of, #cantidad, #barra {
            font-size: 1.2rem;
            font-weight: bold;
            color: #333;
            text-align: center;
            padding: 5px;
        }
        
        #menu {
            background-color: #f8f9fa;
            border-radius: 5px;
            padding: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        #menu input[type="button"] {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            border: none;
            border-radius: 4px;
            background-color: #3498db;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        #menu input[type="button"]:hover {
            background-color: #2980b9;
        }
        
        #menu input[type="button"].mobile-button-disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
        
        #datos {
            background-color: white;
            border-radius: 5px;
            padding: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            flex-grow: 1;
            overflow: auto;
        }
        
        footer {
            background-color: #af4c50;
            color: white;
            padding: 10px 20px;
            text-align: center;
            font-size: 0.9rem;
        }
        
        .ui-grid-c {
            display: flex;
            width: 100%;
            align-items: center;
        }
        
        #hora, #arduino, #toperarios, #it, #info, #pendiente {
            padding: 5px;
        }
        
        #hora {
            width: 15%;
            font-size: 1.1rem;
            font-weight: bold;
        }
        
        #info {
            width: 35%;
            text-align: center;
        }
        
        #pendiente {
            width: 40%;
        }
        
        .ui-grid-b {
            display: flex;
            width: 100%;
        }
        
        .badge {
            display: inline-block;
            padding: 3px 7px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
            color: white;
        }
        
        .badge-success {
            background-color: #28a745;
        }
        
        .badge-danger {
            background-color: #dc3545;
        }
        
        .badge-info {
            background-color: #17a2b8;
        }
        
        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }
        
        .loading-spinner {
            font-size: 50px;
            color: white;
        }
        
        @media (max-width: 768px) {
            .ui-grid-d, .ui-grid-a, .ui-grid-c, .ui-grid-b {
                flex-direction: column;
            }
            
            .ui-block-a, .ui-block-b, .ui-block-c, .ui-block-d, .ui-block-e {
                width: 100%;
            }
            
            header {
                flex-direction: column;
                height: auto;
                padding: 10px;
            }
            
            .app-title {
                font-size: 1.2rem;
                margin: 10px 0;
            }
        }
    </style>
    
    <script>
    // Mantener las funciones JavaScript originales sin cambios
    var ratio = 1;
    var rotar = 0;
    // ... (todo el código JavaScript original se mantiene igual)
    </script>
</head>
<body>
    <header>
        <div class="logo"><img src="../images/logo_transparent.png" alt="KH" class="logo"></div>
        <div class="app-title">Planta de Grupo KH - Panel de Producción</div>
        <div class="header-info">
            <button class="menu-button">☰</button>
            <div class="dropdown-menu" id="dropdownMenu">
                <a href="#" onclick="location.reload()"><i class="fas fa-sync-alt"></i> Actualizar</a>
                <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Cerrar sesión</a>
            </div>
        </div>
    </header>
    
    <div class="main-content">
        <div class="ui-grid-d" id="topbar">
            <div class="ui-block-a" onClick="layout();">  
                <div id="posicion"></div>
                <div id="posicionD"></div>
            </div>
            <div class="ui-block-b" id="referencia"></div>    
            <div class="ui-block-c">
                <div id="descripcion"></div>
                <div id="of"></div>
            </div>
            <div class="ui-block-d" id="cantidad" onClick="reload();"></div>
        </div> 
        
        <div class="ui-grid-a" id="leftbar">
            <div class="ui-block-a" id="menu"> 
                <center><input type="button" value="LOGIN" onClick="login();"></center>
                <center><input type="button" id="OEE" name="OEE" value="OEE" onClick="oee();"></center>
                <center><input type="button" id="OFS" name="OFS" value="O.F.s" onClick="ofs();"></center>
                <center><input type="button" id="NOK" name="NOK" value="PIEZA NOK" onClick="partesnok('','');"></center>
                <center><input type="button" id="INCIDENCIAS" name="INCIDENCIAS" value="INCIDENCIAS" onClick="incidencias();"></center>
                <center><input type="button" id="PI" name="PI" value="P.I." onClick="pi();"></center>
                <center><input type="button" id="PE" name="PE" value="P.E." onClick="pe();"></center>
                <center><input type="button" id="QA" name="QA" value="Q.A." onClick="qa();"></center>
                <center><input type="button" id="LL" name="LL" value="L.L." onClick="ll();"></center>
                <center><input type="button" id="ETIQUETA" name="ETIQUETA" value="ETIQUETA" onClick="etiquetas();"></center> 
                <center><input type="button" id="LOGOUT" name="LOGOUT" value="LOGOUT" onClick="logout();"></center>
            </div>
                
            <div class="ui-block-b" id="datos" data-role="content">
                <!-- Contenido dinámico -->
            </div>
        </div>
    </div>
    
    <footer>
        <div class="ui-grid-c">
            <div class="ui-block-a" id="hora"><h1></h1></div>
            <div class="ui-block-b" id="arduino"></div>
            <div class="ui-block-b" id="toperarios"><h1></h1></div>
            <div class="ui-block-b" id="it" onClick="it();"><img src='../images/info_button_32.png'></div>
            <div class="ui-block-c" id="info"><h1><center>.</center></h1></div>
            <div class="ui-block-b" id="pendiente">
                <div class="ui-grid-b">
                    <div class="ui-block-a">
                        <div class="ui-grid-a">
                            <div class="ui-block-a" id="ref1"></div>
                            <div class="ui-block-a" id="canreal"></div>
                            <div class="ui-block-b" id="canteo"></div>
                        </div>
                    </div>
                    <div class="ui-block-b">
                        <div class="ui-grid-a">
                            <div class="ui-block-a" id="ref2"></div>
                            <div class="ui-block-a" id="canreal2"></div>
                            <div class="ui-block-b" id="canteo2"></div>
                        </div>
                    </div>
                    <div class="ui-block-c">
                        <div class="ui-grid-a">
                            <div class="ui-block-a" id="ref3"></div>
                            <div class="ui-block-a" id="canreal3"></div>
                            <div class="ui-block-b" id="canteo3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Overlay de carga -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i>
        </div>
    </div>

    <script>
    // Configuración del menú desplegable
    document.querySelector('.menu-button').addEventListener('click', function(e) {
        e.stopPropagation();
        document.getElementById('dropdownMenu').classList.toggle('show');
    });

    document.addEventListener('click', function() {
        document.getElementById('dropdownMenu').classList.remove('show');
    });

    // Inicializar la posición
    $( "#posicion" ).empty();
    $( "#posicion" ).append( posicion );
    escalar();
    </script>
</body>
</html>